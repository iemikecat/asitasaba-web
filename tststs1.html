<!DOCTYPE html>
<html lang="jp">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お知らせ</title>
    <link rel="manifest" href="/manifest.json">

    <style>

        /* Free Humberger Menu */
        /* 使う場合は連絡下せえ */

        header {
            width: 100%;
            height: 60px;
            line-height: 60px;
            padding-left: 15px;
            padding-right: 15px;
            box-sizing: border-box;
            background-color: #ffffff;
            position: fixed;
            z-index: 3;
            box-shadow: 0 0 16px gray;
        }

        header h3 {
            float: left;
            margin: 0;
            color: #000000;
        }

        header .menu_button {
            float: left;
            color: #000000;
            line-height: 57px;
            font-size: 36px;
            margin-right: 10px;
        }

        .menu_data {
            float: left;
            width: 20%;
            height: calc(100% - 60px);
            margin-top: 60px;
            margin-left: -20%;
            box-sizing: border-box;
            background-color: #ffffff;
            /*box-shadow: 0 0 16px gray;*/
            transition: all 300ms 0s ease;
            position: absolute;
            z-index: 2;
        }

        .menu_data .content {
            /*padding: 10px;*/
            box-sizing: border-box;
        }

        /* Phone CSS */
        @media screen and (max-width: 767px) {
            .menu_data {
                width: 50%;
                margin-left: -50%;
            }
        }

        @media screen and (max-width: 479px) {
            .menu_data {
                width: 80%;
                margin-left: -80%;
            }
        }
    </style>

<style>        
    html,
    body {
        width: 100%;
        height: 100%;
        margin: 0;
        font-family: sans-serif;
        background-color: #f6f6f6;
    }

    main {
        height: 100%;
        padding-top: 75px;
        padding-left: 15px;
        padding-right: 15px;
        padding-bottom: 15px;
        height: 100%;
        box-sizing: border-box;
    }

    .info_box {
        width: 100%;
        padding-left: 15px;
        padding-right: 15px;
        margin-bottom: 20px;
        border-radius: 8px;
        text-align: left;
        box-sizing: border-box;
        border: none;
        background-color: #ffffff;
        box-shadow: 0 0 8px gray;
        transition: all 300ms 0s ease;
    }
    
    .info_box:active {
        background-color: #e7e7e7;
        box-shadow: 0 0 8px gray;
    }
    
    .info_box .icon {
        vertical-align: middle;
        margin-top: -5px;
        margin-right: 10px;
        font-size: 2rem;
    }

    .info_box .title {
        font-size: 1rem;
        line-height: 50px;
        margin: 0;
        font-weight: bold;
        color: black;
    }

    .info_box .date {
        float: right;
        line-height: 50px;
        font-size: 0.8rem;
        color: #bdbdbd;
    }
</style>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons%7CMaterial+Icons+Outlined" rel="stylesheet">

    <script src='jquery-3.6.0.min.js'></script>

    <script>
        /* register Service Worker [PWA] */
        if('serviceWorker' in navigator){
            navigator.serviceWorker.register('/service-worker.js').then(function(){
                console.log("Service Worker is registered!!");
            });
        }

        /* Page Load Effect */
        $('head').append(
        '<style>body{display:none;}'
        );
        $(window).on("load", function() {
        $('body').delay(300).fadeIn("slow");
        });

        var IsMenuClicked = false;

        function MenuClick() {
            if (IsMenuClicked == false) {
                IsMenuClicked = true
                /*document.getElementById("menu_data_content").style.visibility = "visible"*/
                document.getElementById("menu_data").style.marginLeft = "0%"
                document.getElementById("menu_data").style.boxShadow = "0 0 16px gray"
            } else {
                IsMenuClicked = false
                document.getElementById("menu_data").style.boxShadow = "none"
                if (window.matchMedia && window.matchMedia('(max-device-width: 479px)').matches) {
                    document.getElementById("menu_data").style.marginLeft = "-80%"
                } else {
                    if (window.matchMedia && window.matchMedia('(max-device-width: 767px)').matches) {
                        document.getElementById("menu_data").style.marginLeft = "-50%"
                    } else {
                        document.getElementById("menu_data").style.marginLeft = "-20%"
                    }
                }
            }
        }

        function LoadInfo() {
            localStorage.setItem("tmp_info_res",JSON.stringify({}));

            var NowURL = location.href;
            fetch(NowURL.replace("https","http").replace("8080","8081").replace("info.html","") + "api/get_infos")
            .then((res)=>{
                return( res.json() );
            })
            .then((json)=>{
                var received_json = json
                localStorage.setItem("tmp_info_res",JSON.stringify(json))
                var addHTML = ""
                for (var i = 0; i < received_json["infos"].length; i++) {
                    var sel_json = received_json["infos"][i];
                    addHTML += `
                        <button class="info_box" onclick="ViewInfo(` + sel_json["id"] + `)">
                            <a class="title">` + sel_json["name"] + `</a>
                            <a class="date">` + sel_json["date"] + `</a>
                        </div>
                        `
                }
                document.getElementById("main").innerHTML = addHTML;
            })
            .catch(error => {
                alert("通信に失敗しました。ホーム画面へ戻ります");
                location.href = "main.html"
            });
        }

        function ViewInfo(InfoID) {
            var target = {}
            var NowURL = location.href
            localStorage.setItem("tmp_info_res_id",InfoID)
            location.href = "info_details.html"
        }
        
    </script>
</head>

<body onload="LoadInfo();">
    <div class="menu_data" id="menu_data">
        <div class="header"></div>
        <div class="content">
            10GB Ethernet
        </div>
    </div>
    <header>
        <button style="float: left; background-color: transparent; border: none;" >
            <span class="material-icons menu_button" onclick="location.href='main.html';">
                arrow_back
            </span>
        </button>
        <h3>お知らせ</h3>
    </header>
    <main id="main">
    </main>
</body>

</html>
